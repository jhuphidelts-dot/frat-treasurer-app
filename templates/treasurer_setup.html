{% extends "base.html" %}

{% block title %}Treasurer Setup - Fraternity Treasurer App{% endblock %}

{% block page_title %}
<i class="fas fa-user-cog"></i> Treasurer Setup
{% endblock %}

{% block content %}
        <p class="text-muted">Configure your personal information and credentials for notifications and integrations.</p>

        {% with messages = get_flashed_messages() %}
        {% if messages %}
            <div class="alert alert-info alert-dismissible fade show" role="alert">
                {% for message in messages %}
                    {{ message }}
                {% endfor %}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
        {% endif %}
        {% endwith %}

        <form method="POST">
            <div class="row">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="fas fa-user"></i> Personal Information</h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label for="name" class="form-label">Full Name</label>
                                <input type="text" class="form-control" id="name" name="name" value="{{ config.name }}">
                            </div>
                            <div class="mb-3">
                                <label for="email" class="form-label">Email Address</label>
                                <input type="email" class="form-control" id="email" name="email" value="{{ config.email }}">
                            </div>
                            <div class="mb-3">
                                <label for="phone" class="form-label">Phone Number</label>
                                <input type="tel" class="form-control" id="phone" name="phone" value="{{ config.phone }}" placeholder="+1234567890">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="fas fa-envelope"></i> Email Configuration</h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label for="smtp_username" class="form-label">SMTP Username (Gmail)</label>
                                <input type="email" class="form-control" id="smtp_username" name="smtp_username" value="{{ config.smtp_username }}">
                            </div>
                            <div class="mb-3">
                                <label for="smtp_password" class="form-label">SMTP App Password</label>
                                <input type="password" class="form-control" id="smtp_password" name="smtp_password" value="{{ config.smtp_password }}">
                                <div class="form-text">Use Google App Password, not your regular Gmail password</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mt-3">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="fas fa-sms"></i> Twilio SMS (Optional)</h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label for="twilio_sid" class="form-label">Account SID</label>
                                <input type="text" class="form-control" id="twilio_sid" name="twilio_sid" value="{{ config.twilio_sid }}">
                            </div>
                            <div class="mb-3">
                                <label for="twilio_token" class="form-label">Auth Token</label>
                                <input type="password" class="form-control" id="twilio_token" name="twilio_token" value="{{ config.twilio_token }}">
                            </div>
                            <div class="mb-3">
                                <label for="twilio_phone" class="form-label">Twilio Phone Number</label>
                                <input type="tel" class="form-control" id="twilio_phone" name="twilio_phone" value="{{ config.twilio_phone }}" placeholder="+1234567890">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="fab fa-google"></i> Google Sheets (Optional)</h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label for="google_credentials_path" class="form-label">Credentials File Path</label>
                                <input type="text" class="form-control" id="google_credentials_path" name="google_credentials_path" value="{{ config.google_credentials_path }}">
                                <div class="form-text">Path to your service account JSON file</div>
                            </div>
                            <div class="mb-3">
                                <label for="google_sheets_id" class="form-label">Google Sheets ID</label>
                                <input type="text" class="form-control" id="google_sheets_id" name="google_sheets_id" value="{{ config.google_sheets_id }}">
                                <div class="form-text">From the Google Sheets URL</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mt-4 d-flex gap-2 flex-wrap">
                <button type="submit" class="btn btn-success">
                    <i class="fas fa-save"></i> Save Configuration
                </button>
                <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i> Back to Dashboard
                </a>
                <a href="{{ url_for('handover_treasurer') }}" class="btn btn-warning">
                    <i class="fas fa-user-check"></i> Handover to New Treasurer
                </a>
                <a href="{{ url_for('optimize_storage') }}" class="btn btn-info" onclick="return confirm('This will compress data files and remove temporary files. Continue?')">
                    <i class="fas fa-compress-arrows-alt"></i> Optimize Storage
                </a>
            </div>
        </form>
{% endblock %}
